!function(){"use strict";function e(e){if("string"!=typeof e)return!1;var n=e.split("-");return 2!==n.length?!1:r(n[0])===!0&&r(n[1])===!0}function r(e){return"string"!=typeof e?!1:-1!==e.search(/^[a-h][1-8]$/)}function n(e){return"string"!=typeof e?!1:-1!==e.search(/^[bw][KQRNBP]$/)}function t(e){if("string"!=typeof e)return!1;e=e.replace(/ .+$/,"");var r=e.split("/");if(8!==r.length)return!1;for(var n=0;8>n;n++)if(""===r[n]||r[n].length>8||-1!==r[n].search(/[^kqrbnpKQRNBP1-8]/))return!1;return!0}function o(e){if("object"!=typeof e)return!1;for(var t in e)if(e.hasOwnProperty(t)===!0&&(r(t)!==!0||n(e[t])!==!0))return!1;return!0}function a(e){return e.toLowerCase()===e?"b"+e.toUpperCase():"w"+e.toUpperCase()}function i(e){var r=e.split("");return"w"===r[0]?r[1].toUpperCase():r[1].toLowerCase()}function s(e){if(t(e)!==!0)return!1;e=e.replace(/ .+$/,"");for(var r=e.split("/"),n={},o=8,i=0;8>i;i++){for(var s=r[i].split(""),p=0,f=0;f<s.length;f++)if(-1!==s[f].search(/[1-8]/)){var u=parseInt(s[f],10);p+=u}else{var d=c[p]+o;n[d]=a(s[f]),p++}o--}return n}function p(e){if(o(e)!==!0)return!1;for(var r="",n=8,t=0;8>t;t++){for(var a=0;8>a;a++){var s=c[a]+n;r+=e.hasOwnProperty(s)===!0?i(e[s]):"1"}7!==t&&(r+="/"),n--}return r=r.replace(/11111111/g,"8"),r=r.replace(/1111111/g,"7"),r=r.replace(/111111/g,"6"),r=r.replace(/11111/g,"5"),r=r.replace(/1111/g,"4"),r=r.replace(/111/g,"3"),r=r.replace(/11/g,"2")}var c="abcdefgh".split("");window.ChessBoard=window.ChessBoard||function(n,a){function i(){return"xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx".replace(/x/g,function(){var e=16*Math.random()|0;return e.toString(16)})}function f(e){return JSON.parse(JSON.stringify(e))}function u(e){var r=e.split(".");return{major:parseInt(r[0],10),minor:parseInt(r[1],10),patch:parseInt(r[2],10)}}function d(e,r){e=u(e),r=u(r);var n=1e4*e.major*1e4+1e4*e.minor+e.patch,t=1e4*r.major*1e4+1e4*r.minor+r.patch;return n>=t}function h(e,r,n){if(a.hasOwnProperty("showErrors")===!0&&a.showErrors!==!1){var t="ChessBoard Error "+e+": "+r;return"console"===a.showErrors&&"object"==typeof console&&"function"==typeof console.log?(console.log(t),void(arguments.length>=2&&console.log(n))):"alert"===a.showErrors?(n&&(t+="\n\n"+JSON.stringify(n)),void window.alert(t)):void("function"==typeof a.showErrors&&a.showErrors(e,r,n))}}function l(){if("string"==typeof n){if(""===n)return window.alert("ChessBoard Error 1001: The first argument to ChessBoard() cannot be an empty string.\n\nExiting..."),!1;var e=document.getElementById(n);if(!e)return window.alert('ChessBoard Error 1002: Element with id "'+n+'" does not exist in the DOM.\n\nExiting...'),!1;pr=$(e)}else if(pr=$(n),1!==pr.length)return window.alert("ChessBoard Error 1003: The first argument to ChessBoard() must be an ID or a single DOM node.\n\nExiting..."),!1;return window.JSON&&"function"==typeof JSON.stringify&&"function"==typeof JSON.parse?$.fn&&$.fn.jquery&&d($.fn.jquery,yr)===!0?!0:(window.alert("ChessBoard Error 1005: Unable to find a valid version of jQuery. Please include jQuery "+yr+" or higher on the page.\n\nExiting..."),!1):(window.alert("ChessBoard Error 1004: JSON does not exist. Please include a JSON polyfill.\n\nExiting..."),!1)}function v(e){return"fast"===e||"slow"===e?!0:parseInt(e,10)+""!=e+""?!1:e>=0}function g(){return("string"==typeof a||o(a)===!0)&&(a={position:a}),"black"!==a.orientation&&(a.orientation="white"),$r=a.orientation,a.showNotation!==!1&&(a.showNotation=!0),a.draggable!==!0&&(a.draggable=!1),"trash"!==a.dropOffBoard&&(a.dropOffBoard="snapback"),a.sparePieces!==!0&&(a.sparePieces=!1),a.sparePieces===!0&&(a.draggable=!0),(a.hasOwnProperty("pieceTheme")!==!0||"string"!=typeof a.pieceTheme&&"function"!=typeof a.pieceTheme)&&(a.pieceTheme="img/chesspieces/wikipedia/{piece}.png"),(a.hasOwnProperty("appearSpeed")!==!0||v(a.appearSpeed)!==!0)&&(a.appearSpeed=200),(a.hasOwnProperty("moveSpeed")!==!0||v(a.moveSpeed)!==!0)&&(a.moveSpeed=200),(a.hasOwnProperty("snapbackSpeed")!==!0||v(a.snapbackSpeed)!==!0)&&(a.snapbackSpeed=50),(a.hasOwnProperty("snapSpeed")!==!0||v(a.snapSpeed)!==!0)&&(a.snapSpeed=25),(a.hasOwnProperty("trashSpeed")!==!0||v(a.trashSpeed)!==!0)&&(a.trashSpeed=100),a.hasOwnProperty("position")===!0&&("start"===a.position?Er=f(br):t(a.position)===!0?Er=s(a.position):o(a.position)===!0?Er=f(a.position):h(7263,"Invalid value passed to config.position.",a.position)),!0}function w(){var e=parseInt(pr.width(),10);if(!e||0>=e)return 0;for(var r=e;r%8!==0&&r>0;)r--;return r/8}function y(){for(var e=0;e<c.length;e++)for(var r=1;8>=r;r++){var n=c[e]+r;Cr[n]=n+"-"+i()}for(var t="KQRBNP".split(""),e=0;e<t.length;e++){var o="w"+t[e],a="b"+t[e];kr[o]=o+"-"+i(),kr[a]=a+"-"+i()}}function m(){var e='<div class="'+Pr.chessboard+'">';return a.sparePieces===!0&&(e+='<div class="'+Pr.sparePieces+" "+Pr.sparePiecesTop+'"></div>'),e+='<div class="'+Pr.board+'"></div>',a.sparePieces===!0&&(e+='<div class="'+Pr.sparePieces+" "+Pr.sparePiecesBottom+'"></div>'),e+="</div>"}function b(e){"black"!==e&&(e="white");var r="",n=f(c),t=8;"black"===e&&(n.reverse(),t=1);for(var o="white",i=0;8>i;i++){r+='<div class="'+Pr.row+'">';for(var s=0;8>s;s++){var p=n[s]+t;r+='<div class="'+Pr.square+" "+Pr[o]+" square-"+p+'" style="width: 12.5%; height: '+hr+'px" id="'+Cr[p]+'" data-square="'+p+'">',a.showNotation===!0&&(("white"===e&&1===t||"black"===e&&8===t)&&(r+='<div class="'+Pr.notation+" "+Pr.alpha+'">'+n[s]+"</div>"),0===s&&(r+='<div class="'+Pr.notation+" "+Pr.numeric+'">'+t+"</div>")),r+="</div>",o="white"===o?"black":"white"}r+='<div class="'+Pr.clearfix+'"></div></div>',o="white"===o?"black":"white","white"===e?t--:t++}return r}function P(e){return"function"==typeof a.pieceTheme?a.pieceTheme(e):"string"==typeof a.pieceTheme?a.pieceTheme.replace(/{piece}/g,e):(h(8272,"Unable to build image source for cfg.pieceTheme."),"")}function O(e,r,n,t){var o='<img src="'+P(r)+'" ';return t&&"string"==typeof t&&(o+='id="'+t+'" '),o+='alt="" class="'+Pr.piece+'" data-piece="'+r+'" '+(e?'style="width: 100%;':'style="width: '+hr+"px;")+"height: "+hr+"px;",n===!0&&(o+="display:none;"),o+='" />'}function x(e){var r=["wK","wQ","wR","wB","wN","wP"];"black"===e&&(r=["bK","bQ","bR","bB","bN","bP"]);for(var n="",t=0;t<r.length;t++)n+=O(!1,r[t],!1,kr[r[t]]);return n}function S(e,r,n,t){var o=$("#"+Cr[e]),a=o.offset(),s=$("#"+Cr[r]),p=s.offset(),c=i();$("body").append(O(!1,n,!0,c));var f=$("#"+c);f.css({display:"",position:"absolute",top:a.top,left:a.left}),o.find("."+Pr.piece).remove();var u=function(){s.append(O(!0,n)),f.remove(),"function"==typeof t&&t()},d=p.top-a.top,h=p.left-a.left,l=Math.sqrt(d*d+h*h),v=2.75*l;200>v&&(v=200),v>700&&(v=700);var g={duration:v,queue:!1,complete:u};f.animate(p,g)}function E(e,r,n){var t=$("#"+kr[e]).offset(),o=$("#"+Cr[r]),s=o.offset(),p=i();$("body").append(O(!1,e,!0,p));var c=$("#"+p);c.css({display:"",position:"absolute",left:t.left,top:t.top});var f=function(){o.find("."+Pr.piece).remove(),o.append(O(!0,e)),c.remove(),"function"==typeof n&&n()},u={duration:a.moveSpeed,complete:f};c.animate(s,u)}function q(e,r,n){function t(){o++,o===e.length&&(M(),xr=!1,a.hasOwnProperty("onMoveEnd")===!0&&"function"==typeof a.onMoveEnd&&a.onMoveEnd(f(r),f(n)))}if(0!==e.length){xr=!0;for(var o=0,i=0;i<e.length;i++)"clear"===e[i].type&&$("#"+Cr[e[i].square]+" ."+Pr.piece).fadeOut(a.trashSpeed,t),"add"===e[i].type&&a.sparePieces!==!0&&$("#"+Cr[e[i].square]).append(O(!1,e[i].piece,!0)).find("."+Pr.piece).fadeIn(a.appearSpeed,t),"add"===e[i].type&&a.sparePieces===!0&&E(e[i].piece,e[i].square,t),"move"===e[i].type&&S(e[i].source,e[i].destination,e[i].piece,t)}}function k(e,r){e=e.split("");var n=c.indexOf(e[0])+1,t=parseInt(e[1],10);r=r.split("");var o=c.indexOf(r[0])+1,a=parseInt(r[1],10),i=Math.abs(n-o),s=Math.abs(t-a);return i>=s?i:s}function C(e){for(var r=[],n=0;8>n;n++)for(var t=0;8>t;t++){var o=c[n]+(t+1);e!==o&&r.push({square:o,distance:k(e,o)})}r.sort(function(e,r){return e.distance-r.distance});for(var a=[],n=0;n<r.length;n++)a.push(r[n].square);return a}function T(e,r,n){for(var t=C(n),o=0;o<t.length;o++){var a=t[o];if(e.hasOwnProperty(a)===!0&&e[a]===r)return a}return!1}function B(e,r){e=f(e),r=f(r);var n=[],t={};for(var o in r)r.hasOwnProperty(o)===!0&&e.hasOwnProperty(o)===!0&&e[o]===r[o]&&(delete e[o],delete r[o]);for(var o in r)if(r.hasOwnProperty(o)===!0){var a=T(e,r[o],o);a!==!1&&(n.push({type:"move",source:a,destination:o,piece:r[o]}),delete e[a],delete r[o],t[o]=!0)}for(var o in r)r.hasOwnProperty(o)===!0&&(n.push({type:"add",square:o,piece:r[o]}),delete r[o]);for(var o in e)e.hasOwnProperty(o)===!0&&t.hasOwnProperty(o)!==!0&&(n.push({type:"clear",square:o,piece:e[o]}),delete e[o]);return n}function M(){cr.find("."+Pr.piece).remove();for(var e in Er)Er.hasOwnProperty(e)===!0&&$("#"+Cr[e]).append(O(!0,Er[e]))}function N(){cr.html(b($r)),M(),a.sparePieces===!0&&("white"===$r?(ur.html(x("black")),dr.html(x("white"))):(ur.html(x("white")),dr.html(x("black"))))}function I(e,r){e=f(e);for(var n in r)if(r.hasOwnProperty(n)===!0&&e.hasOwnProperty(n)===!0){var t=e[n];delete e[n],e[r[n]]=t}return e}function D(e){var r=f(Er),n=f(e),t=p(r),o=p(n);t!==o&&(a.hasOwnProperty("onChange")===!0&&"function"==typeof a.onChange&&a.onChange(r,n),Er=e)}function j(e,r){for(var n in wr)if(wr.hasOwnProperty(n)===!0){var t=wr[n];if(e>=t.left&&e<t.left+hr&&r>=t.top&&r<t.top+hr)return n}return"offboard"}function X(){wr={};for(var e in Cr)Cr.hasOwnProperty(e)===!0&&(wr[e]=$("#"+Cr[e]).offset())}function Y(){cr.find("."+Pr.square).removeClass(Pr.highlight1+" "+Pr.highlight2)}function J(){function e(){M(),fr.css("display","none"),a.hasOwnProperty("onSnapbackEnd")===!0&&"function"==typeof a.onSnapbackEnd&&a.onSnapbackEnd(lr,gr,f(Er),$r)}if("spare"===gr)return void Q();Y();var r=$("#"+Cr[gr]).offset(),n={duration:a.snapbackSpeed,complete:e};fr.animate(r,n),qr=!1}function Q(){Y();var e=f(Er);delete e[gr],D(e),M(),fr.fadeOut(a.trashSpeed),qr=!1}function R(e){Y();var r=f(Er);delete r[gr],r[e]=lr,D(r);var n=$("#"+Cr[e]).offset(),t=function(){M(),fr.css("display","none"),a.hasOwnProperty("onSnapEnd")===!0&&"function"==typeof a.onSnapEnd&&a.onSnapEnd(gr,e,lr)},o={duration:a.snapSpeed,complete:t};fr.animate(n,o),qr=!1}function K(e,r,n,t){("function"!=typeof a.onDragStart||a.onDragStart(e,r,f(Er),$r)!==!1)&&(qr=!0,lr=r,gr=e,vr="spare"===e?"offboard":e,X(),fr.attr("src",P(r)).css({display:"",position:"absolute",left:n-hr/2,top:t-hr/2}),"spare"!==e&&$("#"+Cr[e]).addClass(Pr.highlight1).find("."+Pr.piece).css("display","none"))}function L(e,n){fr.css({left:e-hr/2,top:n-hr/2});var t=j(e,n);t!==vr&&(r(vr)===!0&&$("#"+Cr[vr]).removeClass(Pr.highlight2),r(t)===!0&&$("#"+Cr[t]).addClass(Pr.highlight2),"function"==typeof a.onDragMove&&a.onDragMove(t,vr,gr,lr,f(Er),$r),vr=t)}function U(e){var n="drop";if("offboard"===e&&"snapback"===a.dropOffBoard&&(n="snapback"),"offboard"===e&&"trash"===a.dropOffBoard&&(n="trash"),a.hasOwnProperty("onDrop")===!0&&"function"==typeof a.onDrop){var t=f(Er);"spare"===gr&&r(e)===!0&&(t[e]=lr),r(gr)===!0&&"offboard"===e&&delete t[gr],r(gr)===!0&&r(e)===!0&&(delete t[gr],t[e]=lr);var o=f(Er),i=a.onDrop(gr,e,lr,t,o,$r);("snapback"===i||"trash"===i)&&(n=i)}"snapback"===n?J():"trash"===n?Q():"drop"===n&&R(e)}function z(){return"ontouchstart"in document.documentElement}function A(){return navigator&&navigator.userAgent&&-1!==navigator.userAgent.search(/MSIE/)}function F(e){e.preventDefault()}function W(e){if(a.draggable===!0){var n=$(this).attr("data-square");if(a.clickMove!==!0){if(r(n)!==!0||Er.hasOwnProperty(n)!==!0)return;K(n,Er[n],e.pageX,e.pageY)}else{if(r(n)!==!0)return;e=e.originalEvent,H(n,e.pageX,e.pageY)}}}function G(e){if(a.draggable===!0){var n=$(this).attr("data-square");if(a.clickMove!==!0){if(r(n)!==!0||Er.hasOwnProperty(n)!==!0)return;e=e.originalEvent,K(n,Er[n],e.changedTouches[0].pageX,e.changedTouches[0].pageY)}else{if(r(n)!==!0)return;e=e.originalEvent,H(n,e.changedTouches[0].pageX,e.changedTouches[0].pageY)}}}function H(e){if(Tr){if(Er.hasOwnProperty(e)!==!0)return;var r=Er[e];if(a.onDragStart(e,r,f(Er),$r)===!1)return;Tr=!1,qr=!0,lr=r,gr=e,vr=e,X(),$("#"+Cr[e]).addClass(Pr.highlight1)}else e==gr?($("#"+Cr[e]).removeClass(Pr.highlight1),Tr=!0):(Tr=!0,U(e))}function V(e){if(a.sparePieces===!0){var r=$(this).attr("data-piece");K("spare",r,e.pageX,e.pageY)}}function Z(e){if(a.sparePieces===!0){var r=$(this).attr("data-piece");e=e.originalEvent,K("spare",r,e.changedTouches[0].pageX,e.changedTouches[0].pageY)}}function _(e){qr===!0&&L(e.pageX,e.pageY)}function er(e){qr===!0&&(e.preventDefault(),L(e.originalEvent.changedTouches[0].pageX,e.originalEvent.changedTouches[0].pageY))}function rr(e){if(qr===!0&&a.clickMove!==!0){var r=j(e.pageX,e.pageY);U(r)}}function nr(e){if(qr===!0){var r=j(e.originalEvent.changedTouches[0].pageX,e.originalEvent.changedTouches[0].pageY);U(r)}}function tr(e){if(qr===!1&&a.hasOwnProperty("onMouseoverSquare")===!0&&"function"==typeof a.onMouseoverSquare){var n=$(e.currentTarget).attr("data-square");if(r(n)===!0){var t=!1;Er.hasOwnProperty(n)===!0&&(t=Er[n]),a.onMouseoverSquare(n,t,f(Er),$r)}}}function or(e){if(qr===!1&&a.hasOwnProperty("onMouseoutSquare")===!0&&"function"==typeof a.onMouseoutSquare){var n=$(e.currentTarget).attr("data-square");if(r(n)===!0){var t=!1;Er.hasOwnProperty(n)===!0&&(t=Er[n]),a.onMouseoutSquare(n,t,f(Er),$r)}}}function ar(){$("body").on("mousedown mousemove","."+Pr.piece,F),cr.on("mousedown","."+Pr.square,W),pr.on("mousedown","."+Pr.sparePieces+" ."+Pr.piece,V),cr.on("mouseenter","."+Pr.square,tr).on("mouseleave","."+Pr.square,or),A()===!0?(document.ondragstart=function(){return!1},$("body").on("mousemove",_).on("mouseup",rr)):$(window).on("mousemove",_).on("mouseup",rr),z()===!0&&(cr.on("touchstart","."+Pr.square,G),pr.on("touchstart","."+Pr.sparePieces+" ."+Pr.piece,Z),$(window).on("touchmove",er).on("touchend",nr))}function ir(){y(),pr.html(m()),cr=pr.find("."+Pr.board),a.sparePieces===!0&&(ur=pr.find("."+Pr.sparePiecesTop),dr=pr.find("."+Pr.sparePiecesBottom));var e=i();$("body").append(O(!0,"wP",!0,e)),fr=$("#"+e),Sr=parseInt(cr.css("borderLeftWidth"),10),Or.resize()}function sr(){l()===!0&&g()===!0&&(ir(),ar())}a=a||{};var pr,cr,fr,ur,dr,hr,lr,vr,gr,wr,yr="1.7.0",mr="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR",br=s(mr),Pr={alpha:"alpha-d2270",black:"black-3c85d",board:"board-b72b1",chessboard:"chessboard-63f37",clearfix:"clearfix-7da63",highlight1:"highlight1-32417",highlight2:"highlight2-9c5d2",notation:"notation-322f9",numeric:"numeric-fc462",piece:"piece-417db",row:"row-5277c",sparePieces:"spare-pieces-7492f",sparePiecesBottom:"spare-pieces-bottom-ae20f",sparePiecesTop:"spare-pieces-top-4028b",square:"square-55d63",white:"white-1e1d7"},Or={},xr=!1,Sr=2,$r="white",Er={},qr=!1,kr={},Cr={};Or.clear=function(e){Or.position({},e)},Or.destroy=function(){pr.html(""),fr.remove(),pr.unbind()},Or.fen=function(){return Or.position("fen")},Or.flip=function(){return Or.orientation("flip")},Or.move=function(){if(0!==arguments.length){for(var r=!0,n={},t=0;t<arguments.length;t++)if(arguments[t]!==!1)if(e(arguments[t])===!0){var o=arguments[t].split("-");n[o[0]]=o[1]}else h(2826,"Invalid move passed to the move method.",arguments[t]);else r=!1;var a=I(Er,n);return Or.position(a,r),a}},Or.orientation=function(e){return 0===arguments.length?$r:"white"===e||"black"===e?($r=e,N(),$r):"flip"===e?($r="white"===$r?"black":"white",N(),$r):void h(5482,"Invalid value passed to the orientation method.",e)},Or.position=function(e,r){return 0===arguments.length?f(Er):"string"==typeof e&&"fen"===e.toLowerCase()?p(Er):(r!==!1&&(r=!0),"string"==typeof e&&"start"===e.toLowerCase()&&(e=f(br)),t(e)===!0&&(e=s(e)),o(e)!==!0?void h(6482,"Invalid value passed to the position method.",e):void(r===!0?(q(B(Er,e),Er,e),D(e)):(D(e),M())))},Or.resize=function(){hr=w(),cr.css("width","100%"),fr.css({height:hr,width:hr}),a.sparePieces===!0&&pr.find("."+Pr.sparePieces).css("paddingLeft",hr+Sr+"px"),N()},Or.start=function(e){Or.position("start",e)};var Tr=!0;return sr(),Or},window.ChessBoard.fenToObj=s,window.ChessBoard.objToFen=p}();